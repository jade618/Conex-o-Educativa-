<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chamada - Conexão Educativa</title>
    <link rel="shortcut icon" href="../IMG/icone (1).svg" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../CSS/chamada.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" defer></script>
</head>

<body>
    <!-- Navbar harmoniosa e responsiva -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="../index.html">
                <img src="../IMG/Logo escola.svg" alt="Logo" class="logo-navbar">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="professor.html"><i class="bi bi-book"></i> Matérias</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-active" href="chamada.html"><i class="bi bi-people"></i> Chamada</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="notas.html"><i class="bi bi-clipboard-check"></i> Notas</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1 class="page-title"><i class="bi bi-clipboard-check"></i> Chamada - Registro de Presença</h1>
            <p class="page-subtitle">Selecione uma turma para registrar presença ou falta</p>
        </div>

        <!-- Seletor de Data -->
        <div class="date-selector mb-4">
            <label class="form-label"><i class="bi bi-calendar-date"></i> Data da Aula:</label>
            <input type="date" class="form-control" id="dataChamada" style="max-width: 300px;">
        </div>

        <!-- Seletor de Turmas -->
        <div class="turma-selector mb-4">
            <ul class="nav nav-tabs" id="turmaTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="tab6A-tab" data-bs-toggle="tab" data-bs-target="#tab6A" type="button" role="tab">6º Ano A</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab6B-tab" data-bs-toggle="tab" data-bs-target="#tab6B" type="button" role="tab">6º Ano B</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab7A-tab" data-bs-toggle="tab" data-bs-target="#tab7A" type="button" role="tab">7º Ano A</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab7B-tab" data-bs-toggle="tab" data-bs-target="#tab7B" type="button" role="tab">7º Ano B</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab8A-tab" data-bs-toggle="tab" data-bs-target="#tab8A" type="button" role="tab">8º Ano A</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab8B-tab" data-bs-toggle="tab" data-bs-target="#tab8B" type="button" role="tab">8º Ano B</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab9A-tab" data-bs-toggle="tab" data-bs-target="#tab9A" type="button" role="tab">9º Ano A</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="tab9B-tab" data-bs-toggle="tab" data-bs-target="#tab9B" type="button" role="tab">9º Ano B</button>
                </li>
            </ul>
        </div>

        <!-- Conteúdo das Turmas -->
        <div class="tab-content" id="turmaTabsContent">
            <!-- 6A -->
            <div class="tab-pane fade show active" id="tab6A" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 6º Ano A - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela6A">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('6A')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('6A')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('6A')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6B -->
            <div class="tab-pane fade" id="tab6B" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 6º Ano B - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela6B">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('6B')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('6B')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('6B')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 7A -->
            <div class="tab-pane fade" id="tab7A" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 7º Ano A - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela7A">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('7A')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('7A')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('7A')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 7B -->
            <div class="tab-pane fade" id="tab7B" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 7º Ano B - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela7B">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('7B')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('7B')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('7B')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 8A -->
            <div class="tab-pane fade" id="tab8A" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 8º Ano A - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela8A">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('8A')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('8A')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('8A')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 8B -->
            <div class="tab-pane fade" id="tab8B" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 8º Ano B - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela8B">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('8B')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('8B')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('8B')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 9A -->
            <div class="tab-pane fade" id="tab9A" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 9º Ano A - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela9A">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('9A')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('9A')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('9A')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 9B -->
            <div class="tab-pane fade" id="tab9B" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-people"></i> 9º Ano B - Lista de Presença</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Aluno</th>
                                        <th class="text-center">Presente</th>
                                        <th class="text-center">Falta</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela9B">
                                    <!-- Preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button class="btn btn-success" onclick="salvarChamada('9B')"><i class="bi bi-check-circle"></i> Salvar Chamada</button>
                            <button class="btn btn-outline-secondary" onclick="marcarTodosPresentes('9B')">Marcar Todos Presentes</button>
                            <button class="btn btn-outline-warning" onclick="limparChamada('9B')">Limpar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resumo -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="bi bi-bar-chart"></i> Resumo do Dia</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="stat-card">
                            <div class="stat-number" id="totalAlunos">0</div>
                            <div class="stat-label">Total de Alunos</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="stat-card green">
                            <div class="stat-number" id="totalPresentes">0</div>
                            <div class="stat-label">Presentes</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="stat-card red">
                            <div class="stat-number" id="totalFaltas">0</div>
                            <div class="stat-label">Faltas</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="stat-card yellow">
                            <div class="stat-number" id="percentualPresenca">0%</div>
                            <div class="stat-label">% Presença</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2024 Conexão Educativa. Todos os direitos reservados.</p>
    </footer>

    <script>
        // Nomes padrão para cada turma
        const dadosTurmas = {
            '6A': ["Lucas da Silva Santos", "Ana Carolina Oliveira Lima", "Gabriel Pereira Costa", "Isabela Santos Rodrigues", "Felipe Martins Almeida", "Mariana Oliveira Souza", "Rafael Silva Gomes", "Juliana Costa Pereira", "Leonardo Almeida Rodrigues", "Carolina Fernandes Silva", "Pedro Oliveira Santos", "Camila Lima Castro", "Matheus Santos Costa", "Larissa Almeida Rodrigues", "Thiago Martins Oliveira", "Marina Costa Lima", "João Silva Pereira", "Amanda Santos Almeida", "Bruno Oliveira Costa", "Fernanda Lima Santos", "Gustavo Costa Almeida", "Luiza Silva Rodrigues", "Daniel Martins Lima", "Renata Oliveira Costa", "Eduardo Santos Pereira"],
            '6B': ["Lucas Ferreira Rocha", "Isabela Cardoso Gomes", "Gabriel Pereira Mendes", "Carolina Santos Barbosa", "Matheus Lima Fernandes", "Mariana Castro Neves", "Rafael Alves Ribeiro", "Juliana Costa Vieira", "Leonardo Oliveira Carvalho", "Larissa Nunes Pinto", "Pedro Silva Marques", "Camila Rodrigues Teixeira", "Thiago Santos Alencar", "Amanda Costa Viana", "João Martins Medeiros", "Fernanda Almeida Guerra", "Bruno Souza Freitas", "Marina Pereira Lima", "Gustavo Gomes Andrade", "Luiza Carvalho Monteiro", "Daniel Fernandes Campos", "Renata Oliveira Pires", "Eduardo Lima Castro", "Felipe Almeida Dias", "Ana Santos Nogueira"],
            '7A': ["Gabriel Silva Oliveira", "Isabela Costa Santos", "Lucas Almeida Pereira", "Marina Rodrigues Lima", "Pedro Costa Carvalho", "Camila Ferreira Gomes", "Rafael Martins Souza", "Juliana Oliveira Almeida", "Leonardo Santos Lima", "Amanda Costa Barbosa", "Thiago Oliveira Silva", "Larissa Pereira Costa", "Felipe Santos Oliveira", "Bruna Lima Rodrigues", "Bruno Almeida Mendes", "Carla Costa Ferreira", "Daniel Oliveira Santos", "Eduardo Lima Almeida", "Fernanda Silva Costa", "Gustavo Pereira Oliveira", "Helena Rodrigues Lima", "Igor Santos Almeida", "Julia Lima Costa", "Kaique Oliveira Silva", "Leticia Pereira Santos"],
            '7B': ["Matheus Costa Silva", "Ana Beatriz Oliveira", "Pedro Henrique Santos", "Mariana Lima Pereira", "Gabriel Martins Costa", "Camila Rodrigues Almeida", "Rafael Fernandes Lima", "Juliana Sousa Carvalho", "Leonardo Silva Rodrigues", "Amanda Costa Martins", "Thiago Oliveira Santos", "Larissa Almeida Ferreira", "Bruno Sousa Lima", "Fernanda Rodrigues Costa", "Gustavo Almeida Santos", "Luiza Martins Oliveira", "Daniel Pereira Lima", "Renata Costa Almeida", "Eduardo Rodrigues Santos", "Felipe Lima Costa", "Isabela Santos Oliveira", "Lucas Almeida Rodrigues", "Marina Costa Santos", "Pedro Martins Lima", "Camila Oliveira Costa"],
            '8A': ["Victor Hugo Silva", "Luana Cristina Costa", "Kaique Ribeiro Oliveira", "Eduarda Santos Pereira", "Bruno Martins Almeida", "Gabriela Rodrigues Lima", "Guilherme Costa Santos", "Isadora Almeida Costa", "Lucas Ferreira Martins", "Júlia Oliveira Rodrigues", "Mateus Santos Lima", "Manuela Costa Almeida", "Pedro Henrique Silva", "Carla Cristina Oliveira", "Rafael Martins Costa", "Amanda Beatriz Santos", "Gustavo Rodrigues Lima", "Larissa Maria Costa", "Daniel Silva Martins", "Beatriz Almeida Santos", "Thiago Oliveira Costa", "Sofia Rodrigues Lima", "Fábio Santos Almeida", "Marina Costa Oliveira", "Enzo Gabriel Silva"],
            '8B': ["Pedro Lucas Oliveira", "Maria Clara Costa", "Gabriel Afonso Santos", "Ana Júlia Pereira", "Lucas Miguel Almeida", "Sofia Victoria Lima", "Arthur Henrique Costa", "Marina Beatriz Rodrigues", "Bernardo Silva Martins", "Helena Nova Costa", "Davi Lucas Sousa", "Luiza Maria Almeida", "Paulo Eduardo Santos", "Camila Isabella Lima", "Lucas Gabriel Oliveira", "Evelyn Maria Costa", "Eduardo Henrique Silva", "Nicole Alexandra Rodrigues", "Kaique Eduardo Martins", "Isabelly Caroline Costa", "Rafael Lucas Sousa", "Letícia Maria Almeida", "Kaique Miguel Santos", "Ana Beatriz Oliveira", "Bruno Alexander Costa"],
            '9A': ["Thiago André Silva", "Jéssica Cristina Costa", "Kaique Gabriel Oliveira", "Mayara Rodrigues Santos", "Fabrício Almeida Lima", "Natália Costa Pereira", "Bruno Lucas Martins", "Larissa Fernanda Almeida", "Renan Rodrigues Costa", "Milena Silva Oliveira", "Lucas Gabriel Santos", "Cíntia Cristina Lima", "Gustavo Henrique Almeida", "Aline Maria Costa", "Matheus Felipe Oliveira", "Bruna Sousa Santos", "Paulo Vitor Lima", "Caroline Costa Almeida", "Kaique Eduardo Oliveira", "Amanda Beatriz Silva", "Kaique Vinicius Costa", "Jaqueline Regina Santos", "Leonardo Miguel Almeida", "Isabela Helena Costa", "Marcos Paulo Oliveira"],
            '9B': ["Rafael Wellington Silva", "Carla Eunice Costa", "Kaique Robson Oliveira", "Letícia Regina Santos", "César Augusto Lima", "Mirela Cristina Pereira", "Kaique Douglas Almeida", "Nayara Helena Costa", "Elias Gabriel Rodrigues", "Rafaela Caroline Santos", "Murilo Henrique Oliveira", "Stella Marisa Lima", "Victor Hugo Costa", "Alessandra Beatriz Almeida", "Douglas Rafael Oliveira", "Vanessa Cristina Santos", "Igor Gabriel Lima", "Patricia Helena Costa", "Kaique Gabriel Oliveira", "Ariana Carla Pereira", "Leonardo Marcos Silva", "Juliana Marcia Costa", "Kaique Samuel Almeida", "Carla Regina Santos", "Marcos Vinicius Lima"]
        };

        // Inicializar dados da turma se não existirem
        function inicializarTurma(turma) {
            const chave = 'nomes' + turma;
            const existente = localStorage.getItem(chave);
            
            if (!existente) {
                const nomes = dadosTurmas[turma] || [];
                const dados = {
                    nomet: nomes,
                    nota1t: [],
                    nota2t: [],
                    nota3t: []
                };
                localStorage.setItem(chave, JSON.stringify(dados));
                console.log('Turma ' + turma + ' inicializada com ' + nomes.length + ' alunos');
            }
        }

        // Inicializar todas as turmas
        function inicializarTodasTurmas() {
            const turmas = ['6A', '6B', '7A', '7B', '8A', '8B', '9A', '9B'];
            turmas.forEach(turma => inicializarTurma(turma));
        }

        // Carregar alunos de uma turma
        function carregarAlunos(turma) {
            // Garantir que a turma está inicializada
            inicializarTurma(turma);
            
            const dados = JSON.parse(localStorage.getItem('nomes' + turma));
            return dados ? dados.nomet : [];
        }

        // Renderizar tabela de chamada
        function renderizarTabela(turma) {
            const tbody = document.getElementById(`tabela${turma}`);
            const alunos = carregarAlunos(turma);
            
            tbody.innerHTML = '';
            
            if (alunos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center">Nenhum aluno nesta turma</td></tr>';
                return;
            }
            
            // Carregar chamada do dia
            const data = document.getElementById('dataChamada').value;
            const chamadaSalva = JSON.parse(localStorage.getItem(`chamada_${turma}_${data}`)) || {};
            
            alunos.forEach((aluno, index) => {
                const estado = chamadaSalva[index] || 'presente';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>
                        <div class="d-flex align-items-center">
                            <object data="../IMG/img/icone_perfil.svg" type="image/svg+xml" width="30" height="30" class="me-2"></object>
                            ${aluno}
                        </div>
                    </td>
                    <td class="text-center">
                        <input type="radio" name="presenca_${turma}_${index}" 
                            ${estado === 'presente' ? 'checked' : ''} 
                            value="presente" 
                            onchange="atualizarEstado('${turma}', ${index}, 'presente')">
                    </td>
                    <td class="text-center">
                        <input type="radio" name="presenca_${turma}_${index}" 
                            ${estado === 'falta' ? 'checked' : ''} 
                            value="falta" 
                            onchange="atualizarEstado('${turma}', ${index}, 'falta')">
                    </td>
                `;
                tbody.appendChild(tr);
            });
            
            atualizarResumo();
        }

        // Atualizar estado de presença
        let estadosChamada = {};

        function atualizarEstado(turma, index, estado) {
            if (!estadosChamada[turma]) {
                estadosChamada[turma] = {};
            }
            estadosChamada[turma][index] = estado;
            atualizarResumo();
        }

        // Marcar todos como presentes
        function marcarTodosPresentes(turma) {
            const alunos = carregarAlunos(turma);
            if (!estadosChamada[turma]) {
                estadosChamada[turma] = {};
            }
            for (let i = 0; i < alunos.length; i++) {
                estadosChamada[turma][i] = 'presente';
                const radioPresente = document.querySelector(`input[name="presenca_${turma}_${i}"][value="presente"]`);
                const radioFalta = document.querySelector(`input[name="presenca_${turma}_${i}"][value="falta"]`);
                if (radioPresente) radioPresente.checked = true;
                if (radioFalta) radioFalta.checked = false;
            }
            atualizarResumo();
        }

        // Limpar chamada
        function limparChamada(turma) {
            estadosChamada[turma] = {};
            renderizarTabela(turma);
            atualizarResumo();
        }

        // Salvar chamada
        function salvarChamada(turma) {
            const data = document.getElementById('dataChamada').value;
            if (!data) {
                alert('Por favor, selecione uma data!');
                return;
            }
            
            if (estadosChamada[turma]) {
                localStorage.setItem(`chamada_${turma}_${data}`, JSON.stringify(estadosChamada[turma]));
                alert(`Chamada da turma ${turma} salva com sucesso!`);
            } else {
                alert('Nenhuma alteração foi feita.');
            }
        }

        // Atualizar resumo
        function atualizarResumo() {
            let total = 0;
            let presentes = 0;
            let faltas = 0;
            
            const turmas = ['6A', '6B', '7A', '7B', '8A', '8B', '9A', '9B'];
            
            turmas.forEach(turma => {
                const alunos = carregarAlunos(turma);
                total += alunos.length;
                
                if (estadosChamada[turma]) {
                    Object.values(estadosChamada[turma]).forEach(estado => {
                        if (estado === 'presente') presentes++;
                        if (estado === 'falta') faltas++;
                    });
                } else {
                    // Se não mexeu, considera todos presentes
                    presentes += alunos.length;
                }
            });
            
            const percentual = total > 0 ? Math.round((presentes / total) * 100) : 0;
            
            document.getElementById('totalAlunos').textContent = total;
            document.getElementById('totalPresentes').textContent = presentes;
            document.getElementById('totalFaltas').textContent = faltas;
            document.getElementById('percentualPresenca').textContent = percentual + '%';
        }

        // Carregar todas as turmas
        function carregarTodasTurmas() {
            const turmas = ['6A', '6B', '7A', '7B', '8A', '8B', '9A', '9B'];
            turmas.forEach(turma => renderizarTabela(turma));
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dataChamada').value = today;
            
            // Carregar tabelas
            carregarTodasTurmas();
            
            // Atualizar quando mudar a data
            document.getElementById('dataChamada').addEventListener('change', function() {
                estadosChamada = {};
                carregarTodasTurmas();
            });
        });
    </script>
</body>

</html>
